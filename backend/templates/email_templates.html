<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Email Templates</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --pastel-blue: #eaf6ff;
      --blue-100: #d7efff;
      --blue-200: #c4e7ff;
      --blue-300: #a7dbff;
      --ink: #1f2a44;
      --ink-soft: #64748b;
      --white: #ffffff;
      --border: #d9e2ec;
      --shadow: 0 10px 30px rgba(15, 23, 42, 0.10);
      --radius-lg: 18px;
      --radius-md: 12px;
      --radius-sm: 8px;

      --editable-bg: #f0f9ff;
      --editable-text: #0f172a;
      --editable-focus-bg: #dbeafe;
    }

  [data-theme="dark"] {
  --pastel-blue: #1e293b;
  --blue-100: #334155;
  --blue-200: #475569;
  --blue-300: #64748b;
  --ink: #f1f5f9;
  --ink-soft: #cbd5e1;

  /* ‚úÖ Use a proper gray background instead of black */
  --white: #1e293b;         /* main card/background gray */
  /* or try #1f2937 or #2d3748 depending on how dark you want */

  --border: #334155;
  --shadow: 0 6px 14px rgba(0,0,0,0.4);
}


    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
      background: radial-gradient(circle at top left, var(--blue-100), var(--pastel-blue));
      color: var(--ink);
      min-height: 100vh;
    }

    /* Top nav */
    .tabs {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 20px;
       background: var(--white);
      backdrop-filter: blur(14px);
      border-bottom: 1px solid var(--border);
      position: sticky;
      top: 0;
      z-index: 20;
    }

    .tabs-left {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .tab {
      text-decoration: none;
      color: var(--ink);
      background: var(--pastel-blue);
      padding: 7px 14px;
      border-radius: 999px;
      font-weight: 600;
      font-size: 14px;
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
    }

    .tab:hover {
      transform: translateY(-1px);
      background: var(--blue-200);
    }

    .tab.active {
      background: var(--blue-300);
      color: var(--white);
    }

    .theme-toggle {
      padding: 7px 14px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: var(--pastel-blue);
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      box-shadow: var(--shadow);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .shell {
      max-width: 1100px;
      margin: 26px auto 32px;
      padding: 0 18px 40px;
    }

    .card {
      background: var(--white);
      border-radius: 24px;
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      padding: 22px 22px 26px;
    }

    h1 {
      margin: 0 0 4px;
      font-size: 26px;
    }

    .subtitle {
      margin: 0 0 18px;
      color: var(--ink-soft);
      font-size: 14px;
    }

    details {
      background: linear-gradient(135deg, var(--blue-100), var(--pastel-blue));
      border-radius: 20px;
      border: 1px dashed var(--blue-300);
      padding: 14px 16px 18px;
    }

    summary {
      cursor: pointer;
      font-weight: 600;
      color: var(--ink-soft);
      list-style: none;
    }

    summary::-webkit-details-marker {
      display: none;
    }

    .grid {
      display: grid;
      grid-template-columns: 260px 1fr;
      gap: 18px;
      margin-top: 16px;
      align-items: flex-start;
    }

    .tones {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .tone {
      background: color-mix(in srgb, var(--white) 95%, transparent);
      border-radius: 999px;
      padding: 9px 14px;
      font-size: 14px;
      border: 1px solid var(--border);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: var(--shadow);
      transition: transform 0.12s ease, box-shadow 0.12s ease, background 0.12s ease;
    }

    .tone span {
      font-weight: 600;
    }

    .tone small {
      color: var(--ink-soft);
      font-size: 11px;
    }

    .tone:hover {
      transform: translateY(-1px);
      background: var(--blue-200);
    }

    .tone.active {
      background: var(--blue-300);
      color: var(--white);
    }

    .preview {
      background: var(--white);
      border-radius: 20px;
      border: 1px solid var(--border);
      padding: 18px 18px 20px;
      box-shadow: var(--shadow);
      min-height: 180px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .preview-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 8px;
    }

    .preview-title {
      font-size: 18px;
      font-weight: 700;
    }

    .preview-chip {
      padding: 3px 9px;
      border-radius: 999px;
      font-size: 11px;
      background: var(--blue-100);
      color: var(--ink-soft);
      border: 1px solid var(--blue-200);
    }

    .email-fields {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin: 4px 0 10px;
      position: relative;
    }

    .email-row {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
    }

    .email-label {
      width: 70px;
      font-weight: 600;
      color: var(--ink-soft);
      font-size: 12px;
    }

    .email-input {
      flex: 1;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border);
      padding: 7px 10px;
      font-size: 13px;
      font-family: inherit;
      box-shadow: 0 0 0 rgba(0, 0, 0, 0);
      transition: box-shadow 0.12s ease, border-color 0.12s ease, background 0.12s ease;
    }

    .email-input:focus {
      outline: none;
      border-color: var(--blue-300);
      box-shadow: 0 0 0 1px var(--blue-300);
      background: var(--pastel-blue);
    }

    .ccbcc-toggle {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: var(--blue-100);
      cursor: pointer;
      font-weight: 600;
      box-shadow: var(--shadow);
      margin-left: auto;
    }

    .hidden {
      display: none;
    }

    .subject-chips {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-left: 70px;
      margin-top: 2px;
    }

    .subject-chip {
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 11px;
      cursor: pointer;
      border: 1px solid var(--border);
      background: var(--blue-100);
      color: var(--ink-soft);
    }

    #email-body {
      margin-top: 4px;
      font-size: 14px;
      line-height: 1.55;
    }

    [contenteditable="true"] {
      background-color: var(--editable-bg);
      color: var(--editable-text);
      border-radius: 6px;
      padding: 1px 4px;
      display: inline-block;
      min-width: 60px;
      cursor: text;
    }

    [contenteditable="true"]:focus {
      outline: 1px solid var(--blue-300);
      background-color: var(--editable-focus-bg);
    }

    [contenteditable="true"][data-placeholder]:empty::before {
      content: attr(data-placeholder);
      color: var(--ink-soft);
      pointer-events: none;
    }

    .preview-footer {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      justify-content: space-between;
    }

    .btn {
      border-radius: 999px;
      padding: 7px 14px;
      border: none;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: var(--shadow);
      transition: transform 0.12s ease, box-shadow 0.12s ease, background 0.12s ease;
    }

    .btn-primary {
      background: #2563eb;
      color: #eff6ff;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 30px rgba(37, 99, 235, 0.4);
    }

    .btn-ghost {
      background: var(--pastel-blue);
      color: var(--ink);
      border: 1px solid var(--border);
    }

    .btn-ghost:hover {
      background: var(--blue-200);
    }

    /* Saved templates block */
    .saved-bar {
      margin-top: 8px;
      padding: 8px 10px;
      border-radius: 12px;
      background: rgba(148, 163, 184, 0.08);
      border: 1px dashed var(--border);
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      color: var(--ink-soft);
    }

    .saved-select {
      border-radius: 999px;
      border: 1px solid var(--border);
      padding: 4px 10px;
      font-size: 11px;
      background: var(--white);
      max-width: 160px;
    }

    .stats {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      font-size: 11px;
      margin-top: 6px;
      color: var(--ink-soft);
    }

    .stat-pill {
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.12);
      border: 1px solid rgba(148, 163, 184, 0.3);
    }

    .back {
      margin-top: 18px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 7px 13px;
      border-radius: 999px;
      background: var(--pastel-blue);
      color: var(--ink);
      border: 1px solid var(--border);
      text-decoration: none;
      font-size: 13px;
      font-weight: 600;
      box-shadow: var(--shadow);
    }

    @media (max-width: 780px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <nav class="tabs">
    <div class="tabs-left">
      <a class="tab" href="{{ url_for('home') }}">Home</a>
      <a class="tab active" href="{{ url_for('email_templates') }}">Email Templates</a>
    </div>
    <button class="theme-toggle" id="themeToggle">
      üåô <span id="themeLabel">Dark Mode</span>
    </button>
  </nav>

  <main class="shell">
    <section class="card">
      <h1>Email Templates</h1>
      <p class="subtitle">
        Pick a tone on the left, personalize the placeholders, then copy or save your version for later.
      </p>

      <details open>
        <summary>‚ñº Click here for additional templates</summary>

        <div class="grid">
          <!-- Left: tone picker -->
          <div class="tones">
            <div class="tone active" data-tone="friendly">
              <span>Friendly</span>
              <small>check-in</small>
            </div>
            <div class="tone" data-tone="serious">
              <span>Serious</span>
              <small>formal reminder</small>
            </div>
            <div class="tone" data-tone="business">
              <span>Business-Professional</span>
              <small>status update</small>
            </div>
            <div class="tone" data-tone="reminder">
              <span>Reminder</span>
              <small>quick ping</small>
            </div>
            <div class="tone" data-tone="apology">
              <span>Apology</span>
              <small>own a mistake</small>
            </div>
            <div class="tone" data-tone="thankyou">
              <span>Thank You</span>
              <small>gratitude</small>
            </div>
          </div>

          <!-- Right: preview / email editor -->
          <div class="preview" id="preview">
            <div class="preview-header">
              <div>
                <div class="preview-title" id="previewTitle">Friendly Team Check-In</div>
                <div class="preview-chip" id="previewToneChip">Tone: Friendly</div>
              </div>
            </div>

            <div class="email-fields">
              <div class="email-row">
                <div class="email-label">To:</div>
                <input id="toField" class="email-input" type="email" placeholder="recipient@example.com">
                <button class="ccbcc-toggle" id="ccbccToggle">+Cc/Bcc</button>
              </div>

              <div id="extraFields" class="hidden">
                <div class="email-row">
                  <div class="email-label">Cc:</div>
                  <input id="ccField" class="email-input" type="text" placeholder="cc@example.com">
                </div>
                <div class="email-row">
                  <div class="email-label">Bcc:</div>
                  <input id="bccField" class="email-input" type="text" placeholder="bcc@example.com">
                </div>
              </div>

              <div class="email-row">
                <div class="email-label">Subject:</div>
                <input id="subjectField" class="email-input" type="text" placeholder="Enter subject here">
              </div>
              <div class="subject-chips" id="subjectChips"></div>
            </div>

            <div id="email-body">
              <!-- body content injected by JS -->
            </div>

            <div class="saved-bar">
              <span style="font-weight:600;">Saved:</span>
              <select id="savedSelect" class="saved-select">
                <option value="">(none)</option>
              </select>
              <button class="btn-ghost btn" id="saveCurrentBtn">Save current</button>
              <button class="btn-ghost btn" id="deleteSavedBtn">Delete selected</button>
            </div>

            <div class="preview-footer">
              <div style="display:flex; gap:6px; flex-wrap:wrap;">
                <button class="btn btn-primary" id="copyBtn">Copy Email</button>
                <button class="btn btn-ghost" id="clearBtn">Clear fields</button>
              </div>
              <div class="stats">
                <div class="stat-pill" id="templatesCount">Custom templates: 0</div>
                <div class="stat-pill" id="lastCopied">Last copied: ‚Äî</div>
              </div>
            </div>
          </div>
        </div>
      </details>

      <a class="back" href="{{ url_for('home') }}">‚Üê Back to Home</a>
    </section>
  </main>

  <script>
    // -----------------------
    // Template definitions
    // -----------------------
    const EXAMPLES = {
      friendly: {
        title: "Friendly Team Check-In",
        body: `Hi everyone,<br><br>
I hope you‚Äôre all doing well! I just wanted to check in with our upcoming deadline for <span contenteditable="true" data-placeholder="[project name]"></span> in <span contenteditable="true" data-placeholder="[class name]"></span>, which is due on <span contenteditable="true" data-placeholder="[due date]"></span>.<br><br>
I‚Äôve completed my part of <span contenteditable="true" data-placeholder="[your completed task]"></span>, and I noticed we still need to finish <span contenteditable="true" data-placeholder="[remaining tasks]"></span>.<br><br>
Please let me know if there‚Äôs anything I can do to help.<br><br>
Sincerely,<br>
<span contenteditable="true" data-placeholder="[Your Name]"></span>`
      },
      serious: {
        title: "Formal Project Follow-Up",
        body: `Hello team,<br><br>
This is a reminder regarding our upcoming submission for <span contenteditable="true" data-placeholder="[project name]"></span> in <span contenteditable="true" data-placeholder="[course name]"></span>, due on <span contenteditable="true" data-placeholder="[due date]"></span>.<br><br>
Please ensure all remaining sections are completed by <span contenteditable="true" data-placeholder="[target date]"></span> so we have time for review and compilation.<br><br>
Best regards,<br>
<span contenteditable="true" data-placeholder="[Your Name]"></span>`
      },
      business: {
        title: "Business-Professional Update",
        body: `Dear Team,<br><br>
I wanted to share a quick update on <span contenteditable="true" data-placeholder="[project name]"></span>. We‚Äôve successfully completed <span contenteditable="true" data-placeholder="[completed milestone]"></span> and will now shift focus to <span contenteditable="true" data-placeholder="[next steps]"></span>.<br><br>
Please confirm your availability for our next check-in on <span contenteditable="true" data-placeholder="[date/time]"></span>.<br><br>
Sincerely,<br>
<span contenteditable="true" data-placeholder="[Your Name]"></span>`
      },
      reminder: {
        title: "Friendly Reminder Email",
        body: `Hi <span contenteditable="true" data-placeholder="[Name]"></span>,<br><br>
Just a quick reminder about <span contenteditable="true" data-placeholder="[event/task]"></span> scheduled for <span contenteditable="true" data-placeholder="[date/time]"></span>.<br><br>
If you need any help or want to reschedule, please let me know.<br><br>
Best,<br>
<span contenteditable="true" data-placeholder="[Your Name]"></span>`
      },
      apology: {
        title: "Apology Email",
        body: `Hi <span contenteditable="true" data-placeholder="[Name]"></span>,<br><br>
I wanted to follow up and apologize for <span contenteditable="true" data-placeholder="[specific issue or delay]"></span>. It was never my intention to cause any inconvenience, and I really appreciate your patience.<br><br>
Going forward, I‚Äôll make sure to <span contenteditable="true" data-placeholder="[describe corrective action]"></span> so this doesn‚Äôt happen again.<br><br>
Thank you again for your understanding.<br><br>
Sincerely,<br>
<span contenteditable="true" data-placeholder="[Your Name]"></span>`
      },
      thankyou: {
        title: "Thank You / Appreciation Email",
        body: `Hi <span contenteditable="true" data-placeholder="[Name]"></span>,<br><br>
I just wanted to thank you for <span contenteditable="true" data-placeholder="[specific help, contribution, or collaboration]"></span>.<br><br>
Your support made a real difference in <span contenteditable="true" data-placeholder="[project/event name]"></span>, and I appreciate the time and effort you put in.<br><br>
Looking forward to working together again soon!<br><br>
Best,<br>
<span contenteditable="true" data-placeholder="[Your Name]"></span>`
      }
    };

    const SUBJECT_SUGGESTIONS = {
      friendly: [
        "Quick check-in about our project",
        "Touching base on our deadline",
        "Team status update"
      ],
      serious: [
        "Action needed: upcoming submission",
        "Reminder: project deadline approaching",
        "Important: final edits required"
      ],
      business: [
        "Weekly project status update",
        "Next steps for our collaboration",
        "Follow-up on earlier discussion"
      ],
      reminder: [
        "Friendly reminder üòä",
        "Reminder about our meeting",
        "Checking in about your availability"
      ],
      apology: [
        "My apologies",
        "Apologies for the delay",
        "Following up with an apology"
      ],
      thankyou: [
        "Thank you!",
        "Appreciation for your help",
        "Grateful for your support"
      ]
    };

    // Elements
    const previewTitle = document.getElementById("previewTitle");
    const previewToneChip = document.getElementById("previewToneChip");
    const emailBody = document.getElementById("email-body");
    const tones = document.querySelectorAll(".tone");
    const subjectChipsContainer = document.getElementById("subjectChips");
    const subjectField = document.getElementById("subjectField");
    const toField = document.getElementById("toField");
    const ccbccToggle = document.getElementById("ccbccToggle");
    const extraFields = document.getElementById("extraFields");

    const copyBtn = document.getElementById("copyBtn");
    const clearBtn = document.getElementById("clearBtn");

    const saveCurrentBtn = document.getElementById("saveCurrentBtn");
    const deleteSavedBtn = document.getElementById("deleteSavedBtn");
    const savedSelect = document.getElementById("savedSelect");

    const templatesCount = document.getElementById("templatesCount");
    const lastCopied = document.getElementById("lastCopied");

    // -----------------------
    // Dark mode
    // -----------------------
    const themeToggle = document.getElementById("themeToggle");
    const themeLabel = document.getElementById("themeLabel");

    function applyTheme(theme) {
      if (theme === "dark") {
        document.querySelector("html").setAttribute("data-theme", "dark");
        themeLabel.textContent = "Light Mode";
        themeToggle.firstChild.textContent = "‚òÄÔ∏è";
      } else {
        document.documentElement.removeAttribute("data-theme");
        themeLabel.textContent = "Dark Mode";
        themeToggle.firstChild.textContent = "üåô";
      }
    }

    const storedTheme = localStorage.getItem("theme");
    applyTheme(storedTheme || "light");

    themeToggle.addEventListener("click", () => {
      const current = document.documentElement.getAttribute("data-theme") === "dark" ? "dark" : "light";
      const next = current === "dark" ? "light" : "dark";
      localStorage.setItem("theme", next);
      applyTheme(next);
    });

    // -----------------------
    // Tone switching
    // -----------------------
    function renderSubjectChips(toneKey) {
      subjectChipsContainer.innerHTML = "";
      const suggestions = SUBJECT_SUGGESTIONS[toneKey] || [];
      suggestions.forEach(text => {
        const chip = document.createElement("button");
        chip.type = "button";
        chip.className = "subject-chip";
        chip.textContent = text;
        chip.addEventListener("click", () => {
          subjectField.value = text;
        });
        subjectChipsContainer.appendChild(chip);
      });
    }

    function setTone(key) {
      const data = EXAMPLES[key];
      if (!data) return;

      tones.forEach(t => t.classList.toggle("active", t.dataset.tone === key));
      previewTitle.textContent = data.title;
      previewToneChip.textContent = "Tone: " + data.title.split(" ")[0];
      emailBody.innerHTML = data.body;

      renderSubjectChips(key);
    }

    tones.forEach(toneEl => {
      toneEl.addEventListener("click", () => {
        const key = toneEl.dataset.tone;
        setTone(key);
      });
    });

    // initial tone
    setTone("friendly");

    // -----------------------
    // Cc/Bcc toggle
    // -----------------------
    ccbccToggle.addEventListener("click", () => {
      const isHidden = extraFields.classList.contains("hidden");
      extraFields.classList.toggle("hidden");
      ccbccToggle.textContent = isHidden ? "Hide Cc/Bcc" : "+Cc/Bcc";
    });

    // -----------------------
    // Contenteditable helper:
    // clear placeholder-like text
    // -----------------------
    emailBody.addEventListener("focusin", (e) => {
      if (e.target.hasAttribute("contenteditable")) {
        const txt = e.target.innerText.trim();
        if (txt.startsWith("[") && txt.endsWith("]")) {
          e.target.innerText = "";
        }
      }
    });

    // -----------------------
    // Saved custom templates (localStorage)
    // -----------------------
    const STORAGE_KEY = "cs222_email_templates_v1";

    function loadSavedTemplates() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) return {};
        return JSON.parse(raw);
      } catch {
        return {};
      }
    }

    function saveTemplatesToStorage(templates) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(templates));
      updateStats(templates);
    }

    function updateSavedSelect(templates) {
      savedSelect.innerHTML = `<option value="">(none)</option>`;
      Object.keys(templates).forEach(name => {
        const opt = document.createElement("option");
        opt.value = name;
        opt.textContent = name;
        savedSelect.appendChild(opt);
      });
    }

    function updateStats(templates) {
      const count = Object.keys(templates).length;
      templatesCount.textContent = "Custom templates: " + count;

      const last = localStorage.getItem(STORAGE_KEY + "_lastCopied");
      lastCopied.textContent = "Last copied: " + (last || "‚Äî");
    }

    let savedTemplates = loadSavedTemplates();
    updateSavedSelect(savedTemplates);
    updateStats(savedTemplates);

    saveCurrentBtn.addEventListener("click", () => {
      const name = prompt("Name for this version (e.g., 'Serious prof reminder'):");
      if (!name) return;

      const bodyHTML = emailBody.innerHTML;
      const subject = subjectField.value || "";
      const to = toField.value || "";

      savedTemplates[name] = { body: bodyHTML, subject, to };
      saveTemplatesToStorage(savedTemplates);
      updateSavedSelect(savedTemplates);
      alert("Saved!");
    });

    deleteSavedBtn.addEventListener("click", () => {
      const key = savedSelect.value;
      if (!key) return;
      if (!confirm(`Delete saved template "${key}"?`)) return;
      delete savedTemplates[key];
      saveTemplatesToStorage(savedTemplates);
      updateSavedSelect(savedTemplates);
      savedSelect.value = "";
    });

    savedSelect.addEventListener("change", () => {
      const key = savedSelect.value;
      if (!key || !savedTemplates[key]) return;
      const data = savedTemplates[key];
      emailBody.innerHTML = data.body || "";
      subjectField.value = data.subject || "";
      toField.value = data.to || "";
      updateStats(savedTemplates);
    });

    // -----------------------
    // Copy / Clear
    // -----------------------
    function getPlainEmailText() {
      const lines = [];

      const to = toField.value.trim();
      const subject = subjectField.value.trim();

      if (to) lines.push("To: " + to);
      if (subject) lines.push("Subject: " + subject);
      if (to || subject) lines.push("");

      // innerText will strip HTML tags nicely
      const bodyText = emailBody.innerText.replace(/\n{3,}/g, "\n\n");
      lines.push(bodyText);

      return lines.join("\n");
    }

    copyBtn.addEventListener("click", async () => {
      const text = getPlainEmailText();
      try {
        await navigator.clipboard.writeText(text);
        const now = new Date();
        const stamp = now.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" });
        localStorage.setItem(STORAGE_KEY + "_lastCopied", stamp);
        updateStats(savedTemplates);

        copyBtn.textContent = "Copied!";
        copyBtn.style.backgroundColor = "#16a34a";
        setTimeout(() => {
          copyBtn.textContent = "Copy Email";
          copyBtn.style.backgroundColor = "#2563eb";
        }, 1600);
      } catch (err) {
        alert("Unable to copy automatically. You can still select and copy manually.");
      }
    });

    clearBtn.addEventListener("click", () => {
      toField.value = "";
      subjectField.value = "";
      extraFields.classList.add("hidden");
      ccbccToggle.textContent = "+Cc/Bcc";

      // reset to currently active tone template
      const activeTone = document.querySelector(".tone.active");
      const key = activeTone ? activeTone.dataset.tone : "friendly";
      setTone(key);
    });
  </script>
</body>
</html>
